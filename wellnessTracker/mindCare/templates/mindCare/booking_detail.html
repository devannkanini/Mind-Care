{% extends 'mindCare/home.html' %} 

{% block content %}
<div class="container mt-5">
    <h2>Booking Details #{{ booking.id }}</h2>
    <p class="lead">Session with: **{{ booking.professional.title }}**</p>
    
    <hr>
    
    <div class="row">
        <div class="col-md-6">
            <h4 class="mb-3">ðŸ“… Appointment Status</h4>
            <p><strong>Date & Time:</strong> {{ booking.booking_date }} at {{ booking.booking_time }}</p>
            <p>
                <strong>Booking Status:</strong> 
                <span class="badge 
                    {% if booking.booking_status == 'confirmed' %}bg-success
                    {% elif booking.booking_status == 'pending_payment' %}bg-warning
                    {% else %}bg-danger{% endif %}">
                    {{ booking.get_booking_status_display }}
                </span>
            </p>
            <p><strong>Session Type:</strong> {{ booking.get_session_type_display }}</p>
            <p><strong>Notes:</strong> {{ booking.description|default:"None" }}</p>
        </div>
        
        <div class="col-md-6">
            <h4 class="mb-3">ðŸ’³ Payment Information</h4>
            <p><strong>Amount:</strong> KSh {{ booking.amount }}</p>
            <p>
                <strong>Payment Status:</strong> 
                <span class="badge 
                    {% if booking.payment_status == 'completed' %}bg-success
                    {% elif booking.payment_status == 'pending' %}bg-info
                    {% else %}bg-danger{% endif %}">
                    {{ booking.get_payment_status_display }}
                </span>
            </p>
            {% if booking.checkout_request_id %}
                <p class="small text-muted">M-Pesa ID: {{ booking.checkout_request_id }}</p>
            {% endif %}

            {% if booking.payment_status != 'completed' %}
                <div class="alert alert-danger mt-3">
                    Payment not confirmed. Please check your phone or retry payment.
                </div>
                <a href="{% url 'mindCare:mpesaPayment' booking_id=booking.id %}" class="btn btn-warning btn-sm">
                    Retry Payment
                </a>
            {% endif %}
        </div>
    </div>

    <a href="{% url 'mindCare:help_list' %}" class="btn btn-secondary mt-4">
        Back to Professionals List
    </a>
</div>
{% endblock %}